@base <http://arga.org.au/schemas/fields/>.

@prefix :           <http://arga.org.au/schemas/mapping/>.
@prefix model:      <http://arga.org.au/model/>.
@prefix tsi:        <http://arga.org.au/schemas/maps/tsi/>.
@prefix tsi_model:  <http://arga.org.au/schemas/maps/tsi/model/>.
@prefix bpa:        <http://arga.org.au/schemas/maps/bpa/>.


tsi_model:organisms     :models tsi:organisms.
tsi_model:livestate     :models tsi:organisms.
tsi_model:collecting    :models tsi:collecting.
tsi_model:tissues       :models tsi:tissues.
tsi_model:registrations :models tsi:registrations.


model:bpa_tsi :models bpa:organisms;
              :models bpa:collecting;
              :models bpa:tissues.


tsi:organisms
{
  # multiple sources contribute to the same organism model so we
  # use the first entity_id found which should be the same across all datasets.
  # NB: this must be order independent, otherwise use something like hash_first.
  <entity_id>              :hash tsi:organism:organism_id.
  <entity_id>              :hash tsi:Livestate:Livestate_identifier.

  <organism_id>            :same tsi:organism:organism_id.
  <livestate_id>           :same tsi:Livestate:Livestate_identifier.

  <scientific_name>        :same tsi:organism:scientific_name.
  <sex>                    :same tsi:organism:sex.
  <genotypic_sex>          :same tsi:organism:genotypic_sex.
  <phenotypic_sex>         :same tsi:Livestate:sex_phenotypic.
  <life_stage>             :same tsi:organism:life_stage.
  <reproductive_condition> :same tsi:organism:reproductive_condition.
  <behavior>               :same tsi:organism:behavior.
  <live_state>             :same tsi:organism:livestate.
  <remarks>                :same tsi:organism:remarks.

  <identified_by>          :same tsi:Livestate:identified_by.
  <identification_date>    :same tsi:Livestate:identification_date.
  <disposition>            :same tsi:Livestate:disposed_as.
  <first_observed_at>      :same tsi:Livestate:date_first_observed.
  <last_known_alive_at>    :same tsi:Livestate:last_known_alive.

  <biome>                  :same tsi:Livestate:biome_ENVO.
  <habitat>                :same tsi:Livestate:habitat_ENVO.
  <bioregion>              :same tsi:Livestate:bioregion_ENVO.
  <ibra_imcra>             :same tsi:Livestate:bioregion_IBRA_IMCRA.

  <latitude>               :same tsi:Livestate:source_location_latitude.
  <longitude>              :same tsi:Livestate:source_location_longitude.
  <coordinate_system>      :same tsi:Livestate:coordinate_system.
  <location_source>        :same tsi:Livestate:geocoods_source.
  <holding>                :same tsi:Livestate:holding.
  <holding_id>             :same tsi:Livestate:holding_ID.
  <holding_permit>         :same tsi:Livestate:holding_permit.

  <doi>                    :same tsi:livestate:source_URL.
  <citation>               :same tsi:livestate:data_source.

  <curator>                :same tsi:Record:Curator.
  <curator_orcid>          :same tsi:Record:CuratorID.
  <created_at>             :same tsi:Record:created.
  <updated_at>             :same tsi:Record:modified.

  <publication_entity_id> :hash_first (<doi> <citation>).
}


tsi:collecting {
  <entity_id>          :hash tsi:collecting:specimen_id.
  <material_sample_id> :same tsi:collecting:specimen_id.

  <scientific_name>     :same tsi:collecting:scientific_name.
  <organism_id>         :same tsi:collecting:organism_id.
  <field_collecting_id> :same tsi:collecting:field_collecting_id.

  <event_date>             :same tsi:collecting:event_date.
  <event_time>             :same tsi:collecting:event_time.
  <collected_by>           :same tsi:collecting:collected_by.
  <remarks>                :same tsi:collecting:collection_remarks.
  <identified_by>          :same tsi:collecting:identified_by.
  <identification_remarks> :same tsi:collecting:identification_remarks.

  <locality>                 :same tsi:collecting:locality.
  <country>                  :same tsi:collecting:country.
  <country_code>             :same tsi:collecting:country_code.
  <state_province>           :same tsi:collecting:state_province.
  <county>                   :same tsi:collecting:county.
  <municipality>             :same tsi:collecting:municipality.
  <latitude>                 :same tsi:collecting:latitude.
  <longitude>                :same tsi:collecting:longitude.
  <location_generalisation>  :same tsi:collecting:location_generalisation.
  <elevation>                :same tsi:collecting:elevation.
  <depth>                    :same tsi:collecting:depth.
  <elevation_accuracy>       :same tsi:collecting:elevation_accuracy.
  <depth_accuracy>           :same tsi:collecting:depth_accuracy.
  <location_source>          :same tsi:collecting:location_source.

  <preparation>              :same tsi:collecting:preparation.
  <environment_broad_scale>  :same tsi:collecting:environment_broad_scale.
  <environment_local_scale>  :same tsi:collecting:environment_local_scale.
  <environment_medium>       :same tsi:collecting:environment_medium.
  <habitat>                  :same tsi:collecting:habitat.
  <specific_host>            :same tsi:collecting:specific_host.
  <individual_count>         :same tsi:collecting:individual_count.
  <organism_quantity>        :same tsi:collecting:organism_quantity.
  <organism_quantity_type>   :same tsi:collecting:organism_quantity_type.
  <strain>                   :same tsi:collecting:strain.
  <isolate>                  :same tsi:collecting:isolate.
  <permit>                   :same tsi:Collecting:permit.
  <sampling_protocol>        :same tsi:Collection:sampling_protocol.
  <organism_killed>          :same tsi:Collecting:organism_killed.
  <organism_kill_method>     :same tsi:Collecting:organism_kill_method.
  <field_sample_disposition> :same tsi:Collecting:field_sample_disposition.
  <field_notes>              :same tsi:Collecting:field_notes.

  <citation>                 :same tsi:collecting:data_source.
  <source_url>               :same tsi:collecting:source_URL.
  <doi>                      :same tsi:collecting:source_URL.
}



# tissues
tsi:tissues {
  <entity_id>               :hash tsi:tissues:tissue_id.

  <tissue_id>               :same tsi:tissues:tissue_id.
  <organism_id>             :same tsi:tissues:organism_id.
  <material_sample_id>      :same tsi:tissues:material_sample_id.
  <original_catalogue_name> :same tsi:tissues:original_catalogue_name.
  <current_catalogue_name>  :same tsi:tissues:current_catalogue_name.

  <identification_verified> :same tsi:tissues:identification_verified.
  <reference_material>      :same tsi:tissues:reference_material.
  <registered_by>           :same tsi:tissues:registered_by.
  <registration_date>       :same tsi:tissues:registration_date.

  <custodian>               :same tsi:tissues:tissue_custodian.
  <institution>             :same tsi:tissues:institution.
  <institution_code>        :same tsi:tissues:institution_code.
  <collection>              :same tsi:tissues:collection.
  <collection_code>         :same tsi:tissues:collection_code.

  <status>                  :same tsi:tissues:specimen_status.
  <current_status>          :same tsi:tissues:current_specimen_status.
  <sampling_protocol>       :same tsi:tissues:sampling_protocol.
  <tissue_type>             :same tsi:tissues:tissue_type.
  <disposition>             :same tsi:tissues:tissue_disposition.
  <fixation>                :same tsi:tissues:tissue_fixation.
  <storage>                 :same tsi:tissues:tissue_storage.

  <citation>                :same tsi:tissues:source.
  <source_url>              :same tsi:tissues:source_URL.
  <doi>                     :same tsi:tissues:source_URL.
}


tsi:curators {
  <curator>       :same tsi:Record:Curator.
  <curator_orcid> :same tsi:Record:CuratorID.
}


tsi:registrations {
  <entity_id>               :hash (<institution_code> <collection> <collection_code>).
  <organism_id>             :same tsi:registrations:organism_id.
  <catalogue_id>            :same tsi:registrations:catalogue_id.
  <field_id>                :same tsi:registrations:field_id.

  <scientific_name>         :same tsi:registrations:current_catalogue_name.

  <registered_by>           :same tsi:registrations:registered_by.
  <registered_by_orcid>     :same tsi:registrations:registered_by_ID.
  <registration_date>       :same tsi:registrations:registration_date.
  <institution>             :same tsi:registrations:institution.
  <institution_code>        :same tsi:registrations:institution_code.
  <collection>              :same tsi:registrations:collection.
  <collection_code>         :same tsi:registrations:collection_code.
  <specimen_status>         :same tsi:registrations:specimen_status.

  <reference_material>      :same tsi:reference_material.
  <identification_verified> :same tsi:identification_verified.

  <specimen_type>           :same tsi:registrations:specimen_type.
  <disposition>             :same tsi:registrations:specimen_disposition.
  <fixation>                :same tsi:registrations:specimen_fixation.
  <storage>                 :same tsi:registrations:specimen_storage.

  <citation>                :same tsi:registrations:source.
  <source_url>              :same tsi:registrations:source_URL.
  <doi>                     :same tsi:registrations:source_URL.
}



# bnodes will clash with ones specified in graphs if converted into triples via a union graph
# <publication_entity_id> :hash_first (<doi> <citation>).


bpa:organisms
{
  <entity_id>              :hash bpa:sample_id.

  <organism_id>            :same bpa:sample_id.

  # the scientific name in this dataset is actually the canonical name
  # so we combine it with authorship to get the real scientific name
  <canonical_name>             :same bpa:scientific_name.
  <scientific_name_authorship> :same bpa:scientific_name_authorship.
  <scientific_name>            :combines (<canonical_name> <scientific_name_authorship>).

  <sex>                    :same bpa:sex.
  <genotypic_sex>          :same bpa:genotypic_sex.
  <phenotypic_sex>         :same bpa:phenotypic_sex.
  # life_stage; lifestage; dev_stage; plant_developmental_stage
  <life_stage>             :same bpa:life_stage.
  <live_state>             :same bpa:wild_captive.
  <remarks>                :same bpa:ancillary_notes.

  # identified_by; id_vetting_by
  <identified_by>          :same bpa:identified_by.
  <identification_date>    :same bpa:id_vetting_date.
  <identification_remarks> :same bpa:scientific_name_note.
  <identification_method>  :same bpa:identification_method.

  <habitat>                :same bpa:habitat.

  # <publication_entity_id> :hash_first (<doi> <citation>).
}


bpa:collecting {
  <entity_id>          :hash bpa:sample_id.

  <material_sample_id>  :same bpa:sample_id.
  <organism_id>         :same bpa:sample_id.

  # collector_sample_id; fieldid
  <field_collecting_id> :same bpa:collector_sample_id.

  # the scientific name in this dataset is actually the canonical name
  # so we combine it with authorship to get the real scientific name
  <canonical_name>             :same bpa:scientific_name.
  <scientific_name_authorship> :same bpa:scientific_name_authorship.
  <scientific_name>            :combines (<canonical_name> <scientific_name_authorship>).

  # collection_date; living_collections_event_date
  <event_date>             :same bpa:collection_date.
  <event_time>             :same bpa:collection_time.

  # collector; collected_by; collectors; voucher_herbarium_collector_id
  <collected_by>           :same bpa:collector.
  <remarks>                :same bpa:collection_note.
  # identified_by; id_vetting_by
  <identified_by>          :same bpa:identified_by.
  <identification_date>    :same bpa:id_vetting_date.
  <identification_remarks> :same bpa:scientific_name_note.
  <identification_method>  :same bpa:identification_method.

  # location_text; geo_loc_name; site; location_id; collection_location; sector; region
  <locality>                 :same bpa:location_text.
  <country>                  :same bpa:country.
  # state_or_region; state_or_territory; province
  <state_province>           :same bpa:state_or_region.
  <latitude>                 :same bpa:decimal_latitude_public.
  <latitude>                 :same bpa:latitude.
  <longitude>                :same bpa:decimal_longitude_public.
  <longitude>                :same bpa:longitude.
  <location_generalisation>  :same bpa:location_generalisation.
  <location_restricted>      :same bpa:location_info_restricted.
  # altitude; elev
  <elevation>                :same bpa:elev.
  <depth>                    :same bpa:depth.
  <depth_minimum>            :same bpa:depth_upper.
  <depth_maximum>            :same bpa:depth_lower.
  # location_notes; sample_site_location_description
  <location_notes>           :same bpa:location_notes.

  <environment_broad_scale>  :same bpa:env_broad_scale.
  <environment_local_scale>  :same bpa:env_local_scale.
  <environment_medium>       :same bpa:env_medium.
  <habitat>                  :same bpa:habitat.
  # host_scientific_name; specific_host; host_species_variety; original_source_host_species
  <specific_host>            :same bpa:specific_host.
  # isolate; strain_or_isolate; strain_description; serovar
  <isolate>                  :same bpa:isolate.
  # collection_permit; nagoya_protocol_permit_number,
  <permit>                   :same bpa:collection_permit.
  # collection_method; samp_mat_process
  <sampling_protocol>        :same bpa:collection_method.
}


bpa:tissues {
  <entity_id>               :hash bpa:tissue_number.

  <organism_id>             :same bpa:sample_id.
  <material_sample_id>      :same bpa:sample_id.
  <tissue_id>               :same bpa:tissue_number.


  <registered_by>           :same bpa:voucher_herbarium_recorded_by.
  <registration_date>       :same bpa:voucher_herbarium_event_date.

  <custodian>               :same bpa:specimen_custodian.
  # specimen_id_description; institution_name; museumid; herbarium_code; sample_id_description
  <institution>             :same bpa:institution_name.
  <institution>             :same bpa:specimen_id_description.
  <collection>              :same bpa:tissue_collection.
  <collection_type>         :same bpa:sample_collection_type.

  <status>                  :same bpa:type_status.
  <tissue_type>             :same tsi:tissues:tissue_type.

  <ala_url>                 :same bpa:ala_specimen_url.

  <registered_by_entity_id> :hash bpa:voucher_herbarium_recorded_by.
}
