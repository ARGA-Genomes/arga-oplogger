@base <http://arga.org.au/schemas/fields/>.

@prefix :           <http://arga.org.au/schemas/mapping/>.
@prefix model:      <http://arga.org.au/model/>.
@prefix tsi:        <http://arga.org.au/schemas/maps/tsi/>.
@prefix tsi_model:  <http://arga.org.au/schemas/maps/tsi/model/>.
@prefix bpa:        <http://arga.org.au/schemas/maps/bpa/>.
@prefix bpa_model:  <http://arga.org.au/schemas/maps/bpa/model/>.
@prefix ncbi:       <http://arga.org.au/schemas/maps/ncbi/>.


# The tsi dataset combines subsamples and extractions into one model
# called lab_samples. We transpose a subset of that model into a subsample
tsi_model:lab_samples :models tsi:subsamples.

bpa_model:bpa_tsi :models bpa:subsamples.
model:bpa_tsi :models bpa:subsamples.


ncbi:subsamples {
  <entity_id>           :hash ncbi:record_id.
  <material_sample_id>  :same ncbi:record_id.
  <subsample_id>        :same ncbi:record_id.
  <preparation>         :same ncbi:preparation_type.
}


tsi:subsamples {
  <entity_id>                        :hash tsi:lab_sample:sample_id.

  <organism_id>                      :same tsi:organism:entity_id.
  <tissue_id>                        :same tsi:tissues:tissue_id.
  <subsample_id>                     :same tsi:lab_sample:sample_id.

  <sample_type>                      :same tsi:lab_sample:sample_type.
  <institution>                      :same tsi:lab_sample:sample_repository.
  <institution_code>                 :same tsi:lab_sample:sample_repository_code.
  <name>                             :same tsi:lab_sample:sample_name.
  <custodian>                        :same tsi:lab_sample:sample_custodian.
  <description>                      :same tsi:lab_sample:sample_description.
  <notes>                            :same tsi:lab_sample:sample_notes.

  <culture_method>                   :same tsi:lab_sample:culture_method.
  <culture_media>                    :same tsi:lab_sample:culture_media.
  <weight_or_vol>                    :same tsi:lab_sample:sample_weight_or_vol.
  <preservation_method>              :same tsi:lab_sample:sample_preservation_method.
  <preservation_temperature>         :same tsi:lab_sample:sample_preservation_temperature.
  <preservation_duration>            :same tsi:lab_sample:sample_preservation_duration.
  <quality>                          :same tsi:lab_sample:sample_quality.
  <cell_type>                        :same tsi:lab_sample:sample_cell_type.
  <cell_line>                        :same tsi:lab_sample:cell_line.
  <clone_name>                       :same tsi:lab_sample:clone_name.
  <lab_host>                         :same tsi:lab_sample:lab_host.
  <sample_processing>                :same tsi:lab_sample:sample_processing.
  <sample_pooling>                   :same tsi:lab_sample:sample_pooling.
}


bpa:subsamples {
  <entity_id> :hash bpa:sample_id.

  # can be a subsample of a tissue or a collecting event itself. prioritise tissues.
  <specimen_id> :hash_first (<tissue_id> <material_sample_id>).
  <organism_id> :same bpa:sample_id.
  <material_sample_id> :same bpa:sample_id.
  <tissue_id> :same bpa:tissue_number.
  # bioplatforms_sample_id; bpa_sample_id; sample_id
  <subsample_id> :same bpa:sample_id.
  <subsample_id> :same bpa:bpa_sample_id.

  # tissue; tissue_type; dna_source; sample_type
  <sample_type> :same bpa:sample_type.
  <name> :same bpa:sample_name.
  <custodian> :same bpa:sample_custodian.

  <preservation_method> :same bpa:tissue_preservation.
  <preservation_temperature> :same bpa:tissue_preservation_temperature.
  <quality> :same bpa:sample_quality.

  # sample; ncbi_biosample_accession; ncbi_biosample_accession_number
  <biosample_accession> :same bpa:ncbi_biosample_accession.
}
